{% load form_tags %}
<div class="bg-gray-100 rounded-md mb-2 section" id="shippingSection" 
    hx-trigger="billing-form-completed from:body" 
    hx-get="{% url 'hx_billing_form_completed' %}"
    hx-swap="outerHTML">
    <div class="flex justify-between bg-gray-100 p-2" id="shippingSectionHeader">
        {% if billingFormCompleted %}
            <h2 class="uppercase text-lg font-semibold text-indigo-800">Shipping</h2>
            <button type="button" class="accordion-toggle" data-target="shippingSectionContent">
                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2.5" stroke="currentColor" 
                class="chevron w-6 h-6 stroke-violet-600 rotate-90">
                    <path stroke-linecap="round" stroke-linejoin="round" d="m8.25 4.5 7.5 7.5-7.5 7.5" />
                </svg>
            </button>
        {% else %}
            <h2 class="uppercase text-lg font-semibold text-gray-400">Shipping</h2>
            <button type="button" class="accordion-toggle" data-target="shippingSectionContent" disabled>
                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2.5" stroke="currentColor" 
                class="chevron w-6 h-6 stroke-gray-400">
                    <path stroke-linecap="round" stroke-linejoin="round" d="m8.25 4.5 7.5 7.5-7.5 7.5" />
                </svg>
            </button>
        {% endif %}
    </div>
    <form class="flex flex-col bg-gray-100 py-2 px-4 {% if not billingFormCompleted %} hidden {% endif %}" id="shippingSectionContent"
        hx-post="{% url 'hx_checkout_shipping_form' %}" 
        hx-target="#shippingSection"
        hx-swap="outerHTML" novalidate>
        {% csrf_token %}
        <div class="flex items-center mb-4">
            <input type="checkbox" id="sameAsBillingCheckbox" class="mr-2"
                   hx-get="{% url 'hx_fill_shipping_from_billing' %}"
                   hx-vals='js:{sameAsBilling: event.target.checked}'
                   hx-target="#shippingSectionContent"
                   hx-trigger="change"
                   hx-swap="outerHTML">
            <label for="sameAsBillingCheckbox">Same as billing address</label>
        </div>
        <div class="flex flex-row justify-between">
            {% form_field shippingForm.first_name "w-1/2 fieldWrapper" %}
            {% form_field shippingForm.last_name "w-1/2 pl-4 fieldWrapper" %}
        </div>
        <div class="flex flex-row justify-between">
            {% form_field shippingForm.street_address "w-3/4 fieldWrapper" %}
            {% form_field shippingForm.unit_apt "w-1/4 pl-4 fieldWrapper" %}
        </div>
        <div class="flex flex-row justify-between pb-2">
            {% form_field shippingForm.suburb "w-2/4 fieldWrapper" %}
            {% form_field shippingForm.state "w-1/4 pl-4 fieldWrapper" "* Please select your " %}
            {% form_field shippingForm.postcode "w-1/4 pl-4 fieldWrapper" %}
        </div>
        <div class="flex w-full justify-end">
            <button type="submit" class="next-btn w-1/4 px-4 py-2 mt-2 mb-2 rounded-xl bg-gray-300 text-gray-500" disabled>Next</button>
        </div>
    </form>
</div>